2022-07-21 at 02:48:35 | INFO | configuration.py |                                     get_training_pipeline_config |
 Training pipeline config: TrainingPipelineConfig(experiment_id='541392ff-30a4-4627-b343-eedf6d3ee489', previous_experiment_id=None, artifact_dir='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact', experiment_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/experiment/experiment.csv')
2022-07-21 at 02:48:35 | INFO | pipeline.py |                                     run_pipeline |
 Pipeline starting.
2022-07-21 at 02:48:35 | INFO | pipeline.py |                                     run_pipeline |
 Pipeline experiment: 541392ff-30a4-4627-b343-eedf6d3ee489
2022-07-21 at 02:48:35 | INFO | test.py |                                     main |
 main function execution completed.
2022-07-21 at 02:48:35 | INFO | configuration.py |                                     get_data_ingestion_config |
 Data Ingestion config: DataIngestionConfig(train_dataset_download_url='https://raw.githubusercontent.com/pk1308/datasets/master/BigMartSales/Train.csv', raw_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/raw_data/Train.csv', ingested_test_data_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Test.csv', ingested_train_data_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Train.csv')
2022-07-21 at 02:48:35 | INFO | stage_00_data_ingestion.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Ingestion log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     download_data |
 Downloading file from :[https://raw.githubusercontent.com/pk1308/datasets/master/BigMartSales/Train.csv] into :[/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/raw_data/Train.csv]
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     split_data_as_train_test |
 Reading csv file: [/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/raw_data/Train.csv]
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     split_data_as_train_test |
 Splitting data into train and test
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     split_data_as_train_test |
 Exporting training dataset to file: [/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Train.csv]
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     split_data_as_train_test |
 Exporting test dataset to file: [/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Test.csv]
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     split_data_as_train_test |
 Data Ingestion artifact:[DataIngestionArtifact(train_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Train.csv', test_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage00_data_ingestion/541392ff-30a4-4627-b343-eedf6d3ee489/ingested_data/Test.csv', is_ingested=True, message='Data ingestion completed successfully.')]
2022-07-21 at 02:48:36 | INFO | stage_00_data_ingestion.py |                                     __del__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Ingestion log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 


2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Validation log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 


2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     is_train_test_file_exists |
 Checking if training and test file is available
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     is_train_test_file_exists |
 Is train and test file exists?-> True
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     get_train_and_previous_df |
 Previous experiment id is not available
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     get_and_save_data_drift_report |
 Previous dataframe is not available
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     get_train_and_previous_df |
 Previous experiment id is not available
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     save_data_drift_report_page |
 Previous dataframe is not available
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     initiate_data_validation |
 Data validation artifact: DataValidationArtifact(schema_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/config/schema.yaml', report_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage01_data_validation/541392ff-30a4-4627-b343-eedf6d3ee489/report/report.json', report_page_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage01_data_validation/541392ff-30a4-4627-b343-eedf6d3ee489/report/report.html', is_validated=True, message='Data Validation performed successfully.')
2022-07-21 at 02:48:36 | INFO | stage_01_data_validation.py |                                     __del__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Validation log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 


2022-07-21 at 02:48:36 | INFO | configuration.py |                                     get_data_transformation_config |
 Data transformation config: DataTransformationConfig(transformed_train_dir='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/train', transformed_test_dir='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/test', preprocessed_object_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/preprocessed/preprocessed.pkl')
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Transformation log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Obtaining preprocessing object.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     get_data_transformer_object |
 Categorical columns: ['Item_Identifier', 'Item_Fat_Content', 'Item_Type', 'Outlet_Identifier', 'Outlet_Type']
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     get_data_transformer_object |
 Numerical columns: ['Item_Weight', 'Item_Visibility', 'Item_MRP', 'Outlet_Establishment_Year']
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Obtaining training and test file path.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Selected columns: ['Item_Identifier', 'Item_Weight', 'Item_Fat_Content', 'Item_Visibility', 'Item_Type', 'Item_MRP', 'Outlet_Identifier', 'Outlet_Establishment_Year', 'Outlet_Type', 'Item_Outlet_Sales']
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Loading training and test data as pandas dataframe.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Splitting input and target feature from training and testing dataframe.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Applying preprocessing object on training dataframe and testing dataframe
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     transform |
 Transforming data
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     transform |
 Index(['Item_Weight', 'Item_Visibility', 'Item_MRP',
       'Outlet_Establishment_Year'],
      dtype='object')
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     transform |
 Transforming data
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     transform |
 Index(['Item_Weight', 'Item_Visibility', 'Item_MRP',
       'Outlet_Establishment_Year'],
      dtype='object')
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Saving transformed training and testing array.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Saving preprocessing object.
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     initiate_data_transformation |
 Data transformations artifact: DataTransformationArtifact(is_transformed=True, message='Data transformation successfully.', transformed_train_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/train/Train.npz', transformed_test_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/test/Test.npz', preprocessed_object_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage02_data_transformation/541392ff-30a4-4627-b343-eedf6d3ee489/stage02_data_transformation/preprocessed/preprocessed.pkl')
2022-07-21 at 02:48:36 | INFO | stage_02_data_transformation.py |                                     __del__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Data Transformation log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 


2022-07-21 at 02:48:36 | INFO | configuration.py |                                     get_model_trainer_config |
 Model trainer config: ModelTrainerConfig(trained_model_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl', base_accuracy=0.5, model_config_file_path='config/model.yaml')
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model trainer log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Loading transformed training dataset
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Loading transformed testing dataset
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Splitting training and testing input and target feature
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Extracting model config file path
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Initializing model factory class using above model config file: config/model.yaml
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Expected accuracy: 0.5
2022-07-21 at 02:48:36 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Initiating operation model selection
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     get_best_model |
 Started Initializing model from config file
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.tree' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/tree/__init__.py'> import DecisionTreeRegressor
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ DecisionTreeRegressor().min_samples_leaf=2
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.ensemble' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/ensemble/__init__.py'> import RandomForestRegressor
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.linear_model' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/linear_model/__init__.py'> import LinearRegression
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'xgboost' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/xgboost/__init__.py'> import XGBRegressor
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     get_best_model |
 Initialized model: [InitializedModelDetail(model_serial_number='model_0', model=DecisionTreeRegressor(min_samples_leaf=2), param_grid_search={'criterion': ['squared_error', 'friedman_mse'], 'splitter': ['best'], 'max_depth': [2, 4, 5, 6], 'max_features': ['auto', 'sqrt', 'log2']}, model_name='sklearn.tree.DecisionTreeRegressor'), InitializedModelDetail(model_serial_number='model_1', model=RandomForestRegressor(), param_grid_search={'criterion': ['squared_error', 'absolute_error', 'poisson', 'friedman_mse'], 'n_estimators': [100, 200, 300, 400], 'max_depth': [2, 3, 4, 5], 'max_features': ['auto', 'sqrt', 'log2']}, model_name='sklearn.ensemble.RandomForestRegressor'), InitializedModelDetail(model_serial_number='model_2', model=LinearRegression(), param_grid_search={'fit_intercept': [True, False]}, model_name='sklearn.linear_model.LinearRegression'), InitializedModelDetail(model_serial_number='model_3', model=XGBRegressor(base_score=None, booster=None, callbacks=None,
             colsample_bylevel=None, colsample_bynode=None,
             colsample_bytree=None, early_stopping_rounds=None,
             enable_categorical=False, eval_metric=None, gamma=None,
             gpu_id=None, grow_policy=None, importance_type=None,
             interaction_constraints=None, learning_rate=None, max_bin=None,
             max_cat_to_onehot=None, max_delta_step=None, max_depth=None,
             max_leaves=None, min_child_weight=None, missing=nan,
             monotone_constraints=None, n_estimators=100, n_jobs=None,
             num_parallel_tree=None, predictor=None, random_state=None,
             reg_alpha=None, reg_lambda=None, ...), param_grid_search={'base_score': [0.5, 0.6, 0.7], 'booster': ['gbtree', 'gblinear', 'dart'], 'n_estimators': [100, 200, 300, 400], 'learning_rate': [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, model_name='xgboost.XGBRegressor')]
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.model_selection' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/model_selection/__init__.py'> import GridSearchCV
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(estimator=DecisionTreeRegressor(min_samples_leaf=2),
             param_grid={'criterion': ['squared_error', 'friedman_mse'],
                         'max_depth': [2, 4, 5, 6],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'splitter': ['best']}).cv=3
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=DecisionTreeRegressor(min_samples_leaf=2),
             param_grid={'criterion': ['squared_error', 'friedman_mse'],
                         'max_depth': [2, 4, 5, 6],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'splitter': ['best']}).verbose=3
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=DecisionTreeRegressor(min_samples_leaf=2),
             param_grid={'criterion': ['squared_error', 'friedman_mse'],
                         'max_depth': [2, 4, 5, 6],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'splitter': ['best']},
             verbose=3).n_jobs=-1
2022-07-21 at 02:48:36 | INFO | model_factory.py |                                     execute_grid_search_operation |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training DecisionTreeRegressor Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 02:48:38 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.model_selection' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/model_selection/__init__.py'> import GridSearchCV
2022-07-21 at 02:48:38 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(estimator=RandomForestRegressor(),
             param_grid={'criterion': ['squared_error', 'absolute_error',
                                       'poisson', 'friedman_mse'],
                         'max_depth': [2, 3, 4, 5],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'n_estimators': [100, 200, 300, 400]}).cv=3
2022-07-21 at 02:48:38 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=RandomForestRegressor(),
             param_grid={'criterion': ['squared_error', 'absolute_error',
                                       'poisson', 'friedman_mse'],
                         'max_depth': [2, 3, 4, 5],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'n_estimators': [100, 200, 300, 400]}).verbose=3
2022-07-21 at 02:48:38 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=RandomForestRegressor(),
             param_grid={'criterion': ['squared_error', 'absolute_error',
                                       'poisson', 'friedman_mse'],
                         'max_depth': [2, 3, 4, 5],
                         'max_features': ['auto', 'sqrt', 'log2'],
                         'n_estimators': [100, 200, 300, 400]},
             verbose=3).n_jobs=-1
2022-07-21 at 02:48:38 | INFO | model_factory.py |                                     execute_grid_search_operation |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training RandomForestRegressor Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.model_selection' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/model_selection/__init__.py'> import GridSearchCV
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(estimator=LinearRegression(),
             param_grid={'fit_intercept': [True, False]}).cv=3
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=LinearRegression(),
             param_grid={'fit_intercept': [True, False]}).verbose=3
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3, estimator=LinearRegression(),
             param_grid={'fit_intercept': [True, False]}, verbose=3).n_jobs=-1
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     execute_grid_search_operation |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training LinearRegression Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     class_for_name |
 Executing command: from <module 'sklearn.model_selection' from '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/venv/lib/python3.7/site-packages/sklearn/model_selection/__init__.py'> import GridSearchCV
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(estimator=XGBRegressor(base_score=None, booster=None,
                                    callbacks=None, colsample_bylevel=None,
                                    colsample_bynode=None,
                                    colsample_bytree=None,
                                    early_stopping_rounds=None,
                                    enable_categorical=False, eval_metric=None,
                                    gamma=None, gpu_id=None, grow_policy=None,
                                    importance_type=None,
                                    interaction_constraints=None,
                                    learning_rate=None, max_bin=None,
                                    max_cat_to_o...
                                    max_depth=None, max_leaves=None,
                                    min_child_weight=None, missing=nan,
                                    monotone_constraints=None, n_estimators=100,
                                    n_jobs=None, num_parallel_tree=None,
                                    predictor=None, random_state=None,
                                    reg_alpha=None, reg_lambda=None, ...),
             param_grid={'base_score': [0.5, 0.6, 0.7],
                         'booster': ['gbtree', 'gblinear', 'dart'],
                         'learning_rate': [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7,
                                           0.8, 0.9],
                         'n_estimators': [100, 200, 300, 400]}).cv=3
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3,
             estimator=XGBRegressor(base_score=None, booster=None,
                                    callbacks=None, colsample_bylevel=None,
                                    colsample_bynode=None,
                                    colsample_bytree=None,
                                    early_stopping_rounds=None,
                                    enable_categorical=False, eval_metric=None,
                                    gamma=None, gpu_id=None, grow_policy=None,
                                    importance_type=None,
                                    interaction_constraints=None,
                                    learning_rate=None, max_bin=None,
                                    max_cat...
                                    max_depth=None, max_leaves=None,
                                    min_child_weight=None, missing=nan,
                                    monotone_constraints=None, n_estimators=100,
                                    n_jobs=None, num_parallel_tree=None,
                                    predictor=None, random_state=None,
                                    reg_alpha=None, reg_lambda=None, ...),
             param_grid={'base_score': [0.5, 0.6, 0.7],
                         'booster': ['gbtree', 'gblinear', 'dart'],
                         'learning_rate': [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7,
                                           0.8, 0.9],
                         'n_estimators': [100, 200, 300, 400]}).verbose=3
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     update_property_of_class |
 Executing:$ GridSearchCV(cv=3,
             estimator=XGBRegressor(base_score=None, booster=None,
                                    callbacks=None, colsample_bylevel=None,
                                    colsample_bynode=None,
                                    colsample_bytree=None,
                                    early_stopping_rounds=None,
                                    enable_categorical=False, eval_metric=None,
                                    gamma=None, gpu_id=None, grow_policy=None,
                                    importance_type=None,
                                    interaction_constraints=None,
                                    learning_rate=None, max_bin=None,
                                    max_cat...
                                    min_child_weight=None, missing=nan,
                                    monotone_constraints=None, n_estimators=100,
                                    n_jobs=None, num_parallel_tree=None,
                                    predictor=None, random_state=None,
                                    reg_alpha=None, reg_lambda=None, ...),
             param_grid={'base_score': [0.5, 0.6, 0.7],
                         'booster': ['gbtree', 'gblinear', 'dart'],
                         'learning_rate': [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7,
                                           0.8, 0.9],
                         'n_estimators': [100, 200, 300, 400]},
             verbose=3).n_jobs=-1
2022-07-21 at 03:00:04 | INFO | model_factory.py |                                     execute_grid_search_operation |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> f"Training XGBRegressor Started." <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     get_best_model_from_grid_searched_best_model_list |
 Acceptable model found:GridSearchedBestModel(model_serial_number='model_0', model=DecisionTreeRegressor(min_samples_leaf=2), best_model=DecisionTreeRegressor(criterion='friedman_mse', max_depth=5,
                      max_features='auto', min_samples_leaf=2), best_parameters={'criterion': 'friedman_mse', 'max_depth': 5, 'max_features': 'auto', 'splitter': 'best'}, best_score=0.5863988372108117)
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     get_best_model_from_grid_searched_best_model_list |
 Acceptable model found:GridSearchedBestModel(model_serial_number='model_1', model=RandomForestRegressor(), best_model=RandomForestRegressor(max_depth=5, n_estimators=200), best_parameters={'criterion': 'squared_error', 'max_depth': 5, 'max_features': 'auto', 'n_estimators': 200}, best_score=0.5945624659793366)
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     get_best_model_from_grid_searched_best_model_list |
 Best model: GridSearchedBestModel(model_serial_number='model_1', model=RandomForestRegressor(), best_model=RandomForestRegressor(max_depth=5, n_estimators=200), best_parameters={'criterion': 'squared_error', 'max_depth': 5, 'max_features': 'auto', 'n_estimators': 200}, best_score=0.5945624659793366)
2022-07-21 at 03:11:52 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Best model found on training dataset: GridSearchedBestModel(model_serial_number='model_1', model=RandomForestRegressor(), best_model=RandomForestRegressor(max_depth=5, n_estimators=200), best_parameters={'criterion': 'squared_error', 'max_depth': 5, 'max_features': 'auto', 'n_estimators': 200}, best_score=0.5945624659793366)
2022-07-21 at 03:11:52 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Extracting trained model list.
2022-07-21 at 03:11:52 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Evaluation all trained model on training and testing dataset both
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 {'>>' * 30}Started evaluating model: [{type(model).__name__}] {'<<' * 30}
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train Score		 Test Score		 Average Score
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 0.6079873816380341		 0.5782434160394077		0.5927424935443782
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 Diff test train accuracy: [0.029743965598626465].
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train root mean squared error: [1072.384598824094].
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 Test root mean squared error: [1091.4670316306099].
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 Acceptable model found MetricInfoArtifact(model_name="DecisionTreeRegressor(criterion='friedman_mse', max_depth=5,\n                      max_features='auto', min_samples_leaf=2)", model_object=DecisionTreeRegressor(criterion='friedman_mse', max_depth=5,
                      max_features='auto', min_samples_leaf=2), train_rmse=1072.384598824094, test_rmse=1091.4670316306099, train_accuracy=0.6079873816380341, test_accuracy=0.5782434160394077, model_accuracy=0.5927424935443782, index_number=0). 
2022-07-21 at 03:11:52 | INFO | model_factory.py |                                     evaluate_regression_model |
 {'>>' * 30}Started evaluating model: [{type(model).__name__}] {'<<' * 30}
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train Score		 Test Score		 Average Score
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 0.6143075198632066		 0.5842988530684738		0.5989275334978877
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Diff test train accuracy: [0.030008666794732797].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train root mean squared error: [1063.704828449236].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Test root mean squared error: [1083.603247713091].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Acceptable model found MetricInfoArtifact(model_name='RandomForestRegressor(max_depth=5, n_estimators=200)', model_object=RandomForestRegressor(max_depth=5, n_estimators=200), train_rmse=1063.704828449236, test_rmse=1083.603247713091, train_accuracy=0.6143075198632066, test_accuracy=0.5842988530684738, model_accuracy=0.5989275334978877, index_number=1). 
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 {'>>' * 30}Started evaluating model: [{type(model).__name__}] {'<<' * 30}
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train Score		 Test Score		 Average Score
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 0.5683558352811084		 0.5400156394706834		0.5538234190030088
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Diff test train accuracy: [0.028340195810425017].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train root mean squared error: [1125.28746718563].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Test root mean squared error: [1139.8592282128163].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 {'>>' * 30}Started evaluating model: [{type(model).__name__}] {'<<' * 30}
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Score <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train Score		 Test Score		 Average Score
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 0.7382407233417295		 0.5502057745774622		0.6305024068393055
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Loss <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Diff test train accuracy: [0.1880349487642673].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Train root mean squared error: [876.2975264871363].
2022-07-21 at 03:11:53 | INFO | model_factory.py |                                     evaluate_regression_model |
 Test root mean squared error: [1127.1627407930496].
2022-07-21 at 03:11:53 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Best found model on both training and testing dataset.
2022-07-21 at 03:11:53 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Saving model at path: /home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl
2022-07-21 at 03:11:53 | INFO | stage_03_model_trainer.py |                                     initiate_model_trainer |
 Model Trainer Artifact: ModelTrainerArtifact(is_trained=True, message='Model Trained successfully', trained_model_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl', train_rmse=1063.704828449236, test_rmse=1083.603247713091, train_accuracy=0.6143075198632066, test_accuracy=0.5842988530684738, model_accuracy=0.5989275334978877)
2022-07-21 at 03:11:53 | INFO | stage_03_model_trainer.py |                                     __del__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model trainer log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 03:11:53 | INFO | configuration.py |                                     get_model_evaluation_config |
 Model Evaluation Config: ModelEvaluationConfig(model_evaluation_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage04_model_evaluation/model_evaluation.yaml', time_stamp='2022-07-21-02-48-35').
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model Evaluation log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Converting target column into numpy array.
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Conversion completed target column into numpy array.
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Dropping target column from the dataframe.
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Dropping target column from the dataframe completed.
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Not found any existing model. Hence accepting trained model
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     update_evaluation_report |
 Previous eval result: {}
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     update_evaluation_report |
 Updated eval result:{'best_model': {'model_path': '/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl'}}
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     initiate_model_evaluation |
 Model accepted. Model eval artifact ModelEvaluationArtifact(is_model_accepted=True, evaluated_model_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl') created
2022-07-21 at 03:11:53 | INFO | stage_04_model_evaluation.py |                                     __del__ |
 ====================Model Evaluation log completed.==================== 
2022-07-21 at 03:11:53 | INFO | configuration.py |                                     get_model_pusher_config |
 Model pusher config ModelPusherConfig(export_dir_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/saved_models/20220721031153')
2022-07-21 at 03:11:53 | INFO | stage_05_model_pusher.py |                                     __init__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model Pusher log started.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 03:11:53 | INFO | stage_05_model_pusher.py |                                     export_model |
 Exporting model file: [/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/saved_models/20220721031153/model.pkl]
2022-07-21 at 03:11:53 | INFO | stage_05_model_pusher.py |                                     export_model |
 Trained model: /home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/stage03_model_training/541392ff-30a4-4627-b343-eedf6d3ee489/trained_model/model.pkl is copied in export dir:[/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/saved_models/20220721031153/model.pkl]
2022-07-21 at 03:11:53 | INFO | stage_05_model_pusher.py |                                     export_model |
 Model pusher artifact: [ModelPusherArtifact(is_model_pusher=True, export_model_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/saved_models/20220721031153/model.pkl')]
2022-07-21 at 03:11:53 | INFO | stage_05_model_pusher.py |                                     __del__ |
 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Model Pusher log completed.<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< 
2022-07-21 at 03:11:53 | INFO | pipeline.py |                                     run_pipeline |
 Model pusher artifact: ModelPusherArtifact(is_model_pusher=True, export_model_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/saved_models/20220721031153/model.pkl')
2022-07-21 at 03:11:53 | INFO | pipeline.py |                                     run_pipeline |
 Pipeline completed.
2022-07-21 at 03:11:53 | INFO | pipeline.py |                                     run_pipeline |
 Pipeline experiment: Experiment(experiment_id='541392ff-30a4-4627-b343-eedf6d3ee489', initialization_timestamp='2022-07-21-02-48-35', artifact_dir='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact', running_status=False, start_time=datetime.datetime(2022, 7, 21, 2, 48, 35, 609465), stop_time=datetime.datetime(2022, 7, 21, 3, 11, 53, 236954), execution_time=datetime.timedelta(seconds=1397, microseconds=627489), message='Pipeline has been completed.', experiment_file_path='/home/pk/Desktop/MachineLearning/project/BigMart-Sales-Data/BigmartsalesPrediction/app_artifact/experiment/experiment.csv', accuracy=0.5989275334978877, is_model_accepted=True)
